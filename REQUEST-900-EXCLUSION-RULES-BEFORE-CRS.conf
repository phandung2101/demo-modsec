# ModSecurity Rule Exclusion Rules for Juice Shop
# These rules help reduce false positives for the Juice Shop application

# Allow common JavaScript frameworks and API calls
SecRule REQUEST_URI "@beginsWith /assets/" \
    "id:1000,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=941000-949999"

# Allow file uploads
SecRule REQUEST_URI "@beginsWith /file-upload" \
    "id:1001,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=200004"

# Allow Angular API calls
SecRule REQUEST_URI "@beginsWith /api/" \
    "id:1002,\
    phase:1,\
    pass,\
    nolog,\
    ctl:ruleRemoveById=941130,\
    ctl:ruleRemoveById=942100,\
    ctl:ruleRemoveById=942230,\
    ctl:ruleRemoveById=942260,\
    ctl:ruleRemoveById=942330,\
    ctl:ruleRemoveById=942340,\
    ctl:ruleRemoveById=942370"

# Allow REST operations
SecRule REQUEST_METHOD "@rx ^(POST|PUT|PATCH)$" \
    "id:1003,\
    phase:1,\
    pass,\
    nolog,\
    ctl:requestBodyAccess=On"